<!--
   Copyright 2025 [Catalyst Curator LLC (catalystcurator-ops)]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• Firefighter Task Rescue</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            overflow-x: hidden;
        }

        /* Login Screen Styles */
        .login-container {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, #2d3436 0%, #1e272e 100%);
            position: relative;
            overflow: hidden;
        }

        .login-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,107,107,0.1) 0%, transparent 70%);
            animation: pulse 15s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.5; }
        }

        .login-box {
            background: rgba(45, 52, 54, 0.95);
            padding: 50px 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 400px;
            width: 100%;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .fire-truck-animation {
            text-align: center;
            margin-bottom: 30px;
            font-size: 80px;
            animation: truck-bounce 2s ease-in-out infinite;
        }

        @keyframes truck-bounce {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(-2deg); }
            75% { transform: translateY(-5px) rotate(2deg); }
        }

        .login-title {
            text-align: center;
            margin-bottom: 10px;
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-subtitle {
            text-align: center;
            margin-bottom: 30px;
            color: #95a5a6;
            font-size: 14px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #bdc3c7;
            font-size: 14px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 14px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            background: rgba(255,255,255,0.05);
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #ff6b6b;
            background: rgba(255,255,255,0.08);
            box-shadow: 0 0 20px rgba(255,107,107,0.2);
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255,107,107,0.3);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255,107,107,0.4);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .divider {
            text-align: center;
            margin: 25px 0;
            color: #7f8c8d;
            position: relative;
        }

        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: rgba(255,255,255,0.1);
        }

        .divider::before { left: 0; }
        .divider::after { right: 0; }

        .signup-link {
            text-align: center;
            margin-top: 20px;
            color: #95a5a6;
            font-size: 14px;
        }

        .signup-link a {
            color: #ff6b6b;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .signup-link a:hover {
            color: #ffa500;
        }

        .error-message {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid #e74c3c;
            color: #fff;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
        }

        .success-message {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid #2ecc71;
            color: #fff;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
        }

        /* Main App Styles */
        .app-container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .app-header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(255,107,107,0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .app-title {
            font-size: 32px;
            font-weight: bold;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-profile {
            background: rgba(255,255,255,0.2);
            padding: 10px 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }

        .stat-label {
            color: #95a5a6;
            font-size: 14px;
        }

        .task-container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .task-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .task-input {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: rgba(255,255,255,0.05);
            color: #fff;
            font-size: 16px;
        }

        .add-task-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-task-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(46,204,113,0.4);
        }

        .tasks-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .task-item {
            background: rgba(255,255,255,0.08);
            padding: 20px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .task-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .task-info {
            flex: 1;
        }

        .task-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .task-priority {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 10px;
        }

        .priority-high {
            background: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }

        .priority-medium {
            background: rgba(243, 156, 18, 0.3);
            color: #f39c12;
        }

        .priority-low {
            background: rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }

        .task-actions {
            display: flex;
            gap: 10px;
        }

        .task-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .complete-btn {
            background: rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }

        .delete-btn {
            background: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }

        .task-btn:hover {
            transform: scale(1.05);
        }

        .leaderboard {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
        }

        .leaderboard-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .leaderboard-item {
            background: rgba(255,255,255,0.08);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .leaderboard-rank {
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            font-size: 18px;
            color: #95a5a6;
        }

        .sync-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(46, 204, 113, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                text-align: center;
            }

            .task-input-group {
                flex-direction: column;
            }

            .task-item {
                flex-direction: column;
                gap: 15px;
            }

            .task-actions {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-box">
            <div class="fire-truck-animation">üöí</div>
            <h1 class="login-title">Firefighter Task Rescue</h1>
            <p class="login-subtitle">Your mission-critical task management system</p>
            
            <div id="errorMessage" class="error-message"></div>
            <div id="successMessage" class="success-message"></div>

            <div id="loginForm">
                <div class="input-group">
                    <label for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" placeholder="firefighter@station.com" required>
                </div>
                <div class="input-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required>
                </div>
                <button class="login-btn" onclick="handleLogin()">üî• Login to Dashboard</button>
                
                <div class="divider">OR</div>
                
                <div class="signup-link">
                    Don't have an account? <a href="#" onclick="toggleForm()">Sign Up</a>
                </div>
            </div>

            <div id="signupForm" style="display: none;">
                <div class="input-group">
                    <label for="signupName">Full Name</label>
                    <input type="text" id="signupName" placeholder="John Firefighter" required>
                </div>
                <div class="input-group">
                    <label for="signupEmail">Email Address</label>
                    <input type="email" id="signupEmail" placeholder="firefighter@station.com" required>
                </div>
                <div class="input-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" placeholder="Create a strong password" required>
                </div>
                <button class="login-btn" onclick="handleSignup()">üöí Create Account</button>
                
                <div class="divider">OR</div>
                
                <div class="signup-link">
                    Already have an account? <a href="#" onclick="toggleForm()">Login</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
        <div class="app-header">
            <div class="app-title">üî• Firefighter Task Rescue</div>
            <div class="user-info">
                <div class="user-profile">
                    <span id="userName">Firefighter</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
        </div>

        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-label">Total Tasks</div>
                <div class="stat-value" id="totalTasks">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Completed</div>
                <div class="stat-value" id="completedTasks">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Pending</div>
                <div class="stat-value" id="pendingTasks">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Completion Rate</div>
                <div class="stat-value" id="completionRate">0%</div>
            </div>
        </div>

        <div class="task-container">
            <h2 style="margin-bottom: 20px;">üìã Mission Control</h2>
            <div class="task-input-group">
                <input type="text" id="taskTitle" class="task-input" placeholder="Enter emergency task..." />
                <select id="taskPriority" class="task-input" style="flex: 0 0 150px;">
                    <option value="high">üî¥ High</option>
                    <option value="medium" selected>üü° Medium</option>
                    <option value="low">üü¢ Low</option>
                </select>
                <button class="add-task-btn" onclick="addTask()">+ Add Task</button>
            </div>
            <div class="tasks-list" id="tasksList">
                <div class="loading">Loading your missions...</div>
            </div>
        </div>

        <div class="leaderboard">
            <h2 class="leaderboard-title">üèÜ Top Firefighters</h2>
            <div class="leaderboard-list" id="leaderboardList">
                <div class="loading">Loading leaderboard...</div>
            </div>
        </div>
    </div>

    <div class="sync-indicator" id="syncIndicator">‚òÅÔ∏è Synced to Cloud</div>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'YOUR_SUPABASE_URL';
        const SUPABASE_ANON_KEY = 'YOUR_SUPABASE_ANON_KEY';
        
        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        let currentUser = null;
        let tasks = [];

        // Check if user is already logged in
        async function checkAuth() {
            const { data: { session } } = await supabase.auth.getSession();
            if (session) {
                currentUser = session.user;
                showApp();
                loadUserData();
            }
        }

        // Toggle between login and signup forms
        function toggleForm() {
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const errorMessage = document.getElementById('errorMessage');
            const successMessage = document.getElementById('successMessage');
            
            errorMessage.style.display = 'none';
            successMessage.style.display = 'none';
            
            if (loginForm.style.display === 'none') {
                loginForm.style.display = 'block';
                signupForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                signupForm.style.display = 'block';
            }
        }

        // Handle Login
        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorMessage = document.getElementById('errorMessage');
            const successMessage = document.getElementById('successMessage');

            if (!email || !password) {
                showError('Please fill in all fields');
                return;
            }

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password,
                });

                if (error) throw error;

                currentUser = data.user;
                showSuccess('Login successful! Welcome back! üî•');
                
                setTimeout(() => {
                    showApp();
                    loadUserData();
                }, 1000);

            } catch (error) {
                showError(error.message);
            }
        }

        // Handle Signup
        async function handleSignup() {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;

            if (!name || !email || !password) {
                showError('Please fill in all fields');
                return;
            }

            if (password.length < 6) {
                showError('Password must be at least 6 characters');
                return;
            }

            try {
                const { data, error } = await supabase.auth.signUp({
                    email: email,
                    password: password,
                    options: {
                        data: {
                            full_name: name,
                        }
                    }
                });

                if (error) throw error;

                showSuccess('Account created! Please check your email to verify your account. üöí');
                
                // Create user profile
                await supabase.from('profiles').insert([
                    { 
                        id: data.user.id, 
                        full_name: name,
                        total_tasks: 0,
                        completed_tasks: 0
                    }
                ]);

            } catch (error) {
                showError(error.message);
            }
        }

        // Handle Logout
        async function handleLogout() {
            const { error } = await supabase.auth.signOut();
            if (!error) {
                currentUser = null;
                tasks = [];
                hideApp();
            }
        }

        // Show/Hide UI
        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            
            // Update user name
            const userName = currentUser?.user_metadata?.full_name || currentUser?.email || 'Firefighter';
            document.getElementById('userName').textContent = userName;
        }

        function hideApp() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
        }

        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
            setTimeout(() => errorElement.style.display = 'none', 5000);
        }

        function showSuccess(message) {
            const successElement = document.getElementById('successMessage');
            successElement.textContent = message;
            successElement.style.display = 'block';
            setTimeout(() => successElement.style.display = 'none', 3000);
        }

        function showSyncIndicator() {
            const indicator = document.getElementById('syncIndicator');
            indicator.style.display = 'block';
            setTimeout(() => indicator.style.display = 'none', 2000);
        }

        // Load User Data
        async function loadUserData() {
            await loadTasks();
            await loadLeaderboard();
            updateStats();
        }

        // Load Tasks from Supabase
        async function loadTasks() {
            try {
                const { data, error } = await supabase
                    .from('tasks')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .order('created_at', { ascending: false });

                if (error) throw error;

                tasks = data || [];
                renderTasks();
                updateStats();
            } catch (error) {
                console.error('Error loading tasks:', error);
            }
        }

        // Add Task
        async function addTask() {
            const titleInput = document.getElementById('taskTitle');
            const prioritySelect = document.getElementById('taskPriority');
            
            const title = titleInput.value.trim();
            const priority = prioritySelect.value;

            if (!title) {
                showError('Please enter a task title');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('tasks')
                    .insert([
                        {
                            user_id: currentUser.id,
                            title: title,
                            priority: priority,
                            completed: false,
                        }
                    ])
                    .select();

                if (error) throw error;

                tasks.unshift(data[0]);
                renderTasks();
                updateStats();
                updateUserProfile();
                
                titleInput.value = '';
                showSyncIndicator();
            } catch (error) {
                showError('Failed to add task');
                console.error(error);
            }
        }

        // Complete Task
        async function completeTask(taskId) {
            try {
                const task = tasks.find(t => t.id === taskId);
                const newCompletedState = !task.completed;

                const { error } = await supabase
                    .from('tasks')
                    .update({ completed: newCompletedState })
                    .eq('id', taskId);

                if (error) throw error;

                task.completed = newCompletedState;
                renderTasks();
                updateStats();
                updateUserProfile();
                showSyncIndicator();
            } catch (error) {
                showError('Failed to update task');
                console.error(error);
            }
        }

        // Delete Task
        async function deleteTask(taskId) {
            if (!confirm('Are you sure you want to delete this task?')) return;

            try {
                const { error } = await supabase
                    .from('tasks')
                    .delete()
                    .eq('id', taskId);

                if (error) throw error;

                tasks = tasks.filter(t => t.id !== taskId);
                renderTasks();
                updateStats();
                updateUserProfile();
                showSyncIndicator();
            } catch (error) {
                showError('Failed to delete task');
                console.error(error);
            }
        }

        // Update User Profile Stats
        async function updateUserProfile() {
            const totalTasks = tasks.length;
            const completedTasks = tasks.filter(t => t.completed).length;

            try {
                const { error } = await supabase
                    .from('profiles')
                    .update({
                        total_tasks: totalTasks,
                        completed_tasks: completedTasks
                    })
                    .eq('id', currentUser.id);

                if (error) throw error;
            } catch (error) {
                console.error('Error updating profile:', error);
            }
        }

        // Render Tasks
        function renderTasks() {
            const tasksList = document.getElementById('tasksList');
            
            if (tasks.length === 0) {
                tasksList.innerHTML = '<div class="loading">No tasks yet. Add your first emergency task! üöí</div>';
                return;
            }

            tasksList.innerHTML = tasks.map(task => `
                <div class="task-item ${task.completed ? 'completed' : ''}">
                    <div class="task-info">
                        <div class="task-title">${task.title}</div>
                        <span class="task-priority priority-${task.priority}">
                            ${task.priority === 'high' ? 'üî¥' : task.priority === 'medium' ? 'üü°' : 'üü¢'} 
                            ${task.priority.toUpperCase()}
                        </span>
                    </div>
                    <div class="task-actions">
                        <button class="task-btn complete-btn" onclick="completeTask('${task.id}')">
                            ${task.completed ? '‚Ü©Ô∏è Undo' : '‚úÖ Complete'}
                        </button>
                        <button class="task-btn delete-btn" onclick="deleteTask('${task.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Update Stats
        function updateStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const pending = total - completed;
            const rate = total > 0 ? Math.round((completed / total) * 100) : 0;

            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('pendingTasks').textContent = pending;
            document.getElementById('completionRate').textContent = rate + '%';
        }

        // Load Leaderboard
        async function loadLeaderboard() {
            try {
                const { data, error } = await supabase
                    .from('profiles')
                    .select('full_name, completed_tasks')
                    .order('completed_tasks', { ascending: false })
                    .limit(10);

                if (error) throw error;

                renderLeaderboard(data || []);
            } catch (error) {
                console.error('Error loading leaderboard:', error);
            }
        }

        // Render Leaderboard
        function renderLeaderboard(profiles) {
            const leaderboardList = document.getElementById('leaderboardList');
            
            if (profiles.length === 0) {
                leaderboardList.innerHTML = '<div class="loading">No firefighters on the board yet!</div>';
                return;
            }

            leaderboardList.innerHTML = profiles.map((profile, index) => {
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
                return `
                    <div class="leaderboard-item">
                        <div style="display: flex; align-items: center;">
                            <span class="leaderboard-rank">#${index + 1} ${medal}</span>
                            <span>${profile.full_name || 'Anonymous Firefighter'}</span>
                        </div>
                        <div style="font-weight: bold; color: #2ecc71;">
                            ${profile.completed_tasks} tasks üî•
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Enter key support
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('loginEmail')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            document.getElementById('loginPassword')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            document.getElementById('signupPassword')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSignup();
            });
            document.getElementById('taskTitle')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addTask();
            });
        });

        // Initialize app
        checkAuth();
    </script>
</body>
</html>
